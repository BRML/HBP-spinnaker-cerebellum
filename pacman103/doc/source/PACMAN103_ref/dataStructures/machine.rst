
.. _MachineObjects:

Machine Objects
---------------

A number of key components of the SpiNNaker hardware are captured using
python classes: :ref:`Machine`, :ref:`Chip`, :ref:`Processor` and :ref:`Router`.

These are used by various processes for mapping and generating data files.
The different classes are defined next.


.. _Machine:

Machine
*******

An instance of the *Machine* class captures information about the structure of
the target SpiNnaker machine. It also includes lists of the processors (both
those allocated to a task, and those that are currently free) that is used
during the :ref:`Mapper-overview` process.

=================== ===================
  Field                   Value
=================== ===================
  Defined in           lib/lib_machine
  Class name           Machine
  Generated by         DAO (during initialisation on control's _init_)
  Used by              Partitioner, mapper, router
=================== ===================

An instance of the *Machine* class has the following child elements:

======================= ========================== ========================================================= 
  Element                     Type                    Notes
======================= ========================== ========================================================= 
 hostname                 String                     Name of the host machine
 x_dim                    Int                        Extent of the target SpiNNaker machine in the X-direction
 y_dim                    Int                        Extent of the target SpiNNaker machine in the Y-direction
 machine_type             Int                        Version of target (3 = bunnybot, 4 = 48-node board). This
                                                     format is likely to change in future.
 chips                   List (of type Chip)         List of references to the chips in this machine
 processors              List (of type Processor)    List of references to the processors in this machine
 free_processors         List (of type Processor)    List of references to the currently unassigned processors 
 allocated_processors    List (of type Processor)    List of references to the assigned processors (i.e. those
                                                     that have been allocated a task by the *Mapper* process)
======================= ========================== ========================================================= 


.. _Chip:

Chip
****

An instance of the *Chip* class captures information about a single SpiNNaker node.

=================== ===================
  Field                   Value
=================== ===================
  Defined in           lib/lib_machine
  Class name           Chip
  Generated by         DAO (in _init_ of dao, called by _init_ of control)
  Used by              Partitioner, mapper, router
=================== ===================

Each instance of the *Chip* class has the following fields:

======================= ========================== ========================================================= 
  Element                     Type                    Notes
======================= ========================== ========================================================= 
machine                   Machine                    Reference to parent Machine object
x                         Int                        X index of this chip in the machine array
y                         Int                        Y index of this chip in the machine array
processors                List (of type Processor)   List of references to the processors on this chip
router                    Router                     Reference to the object describing the Router on this chip
======================= ========================== ========================================================= 


.. _Processor:

Processor
*********

An instance of the *Processor* class captures information about individual cores on a SpiNNaker node.

=================== ===================
  Field                   Value
=================== ===================
  Defined in           lib/lib_machine
  Class name           Processor
  Generated by         DAO (during initialisation on control's _init_)
  Used by              Partitioner, mapper
=================== ===================

Each instance of the *Processor* class has the following fields:

======================= ========================== ========================================================= 
  Element                     Type                    Notes
======================= ========================== ========================================================= 
chip                          Chip                  Reference to the parent chip for this processor
idx                           Int                   Processor ID
placement                     Placement             Reference to the placement object describing what task
                                                    is mapped to this processor (allocated by mapper)
======================= ========================== ========================================================= 


.. _Router:

Router
******

An instance of the *Router* class captures the entries into the routing table of a single router on
a single SpiNNaker node.

=================== ===================
  Field                   Value
=================== ===================
  Defined in           lib/lib_machine
  Class name           Router
  Generated by         DAO (during initialisation on control's _init_)
  Used by              router, routingTableCompiler
=================== ===================

Each instance of the *Router* class has the following fields:

======================= ========================== ========================================================= 
  Element                     Type                    Notes
======================= ========================== ========================================================= 
chip                          Chip                  Reference to parent chip for this Router
cam                           Dictionary            CAM containing routing entry info (key, value pairs)
occupancy                     Int                   Number of filled entries for this router
standard_mask                 Int (mask)            Mask applied to all router entries (this is basic
                                                    functionality and will change in future)
======================= ========================== ========================================================= 


